run_tests:
  build: ./
  dockerfile: Dockerfile.tests
compile_binary:
  build: ./
  dockerfile: Dockerfile.compile
  volumes:
    - ./bin:/go/bin
   
build_and_push_image:
  image: codeship/google-cloud-deployment
  encrypted_env_file: google_deployment.env.encrypted
  dockerfile: Dockerfile.build
  add_docker: true
  volumes:
    - ./scripts:/deploy
    - ./bin:/bin
  
google_cloud_deployment:
  tag: master
  image: codeship/google-cloud-deployment
  encrypted_env_file: google_deployment.env.encrypted
  add_docker: true
  volumes:
    - ./scripts:/deploy
